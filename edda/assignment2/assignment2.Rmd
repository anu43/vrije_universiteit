---
title: "assignment1"
author: "nihat uzunalioglu - 2660298, emiel kempen - 2640580, saurabh jain - 2666959"
date: "2/26/2020"
output: pdf_document
---

```{r setup, set.seed(43), include=FALSE}
knitr::opts_chunk$set(fig.height = 2.5)
options(show.signif.stars=FALSE)
```

## Exercise 1
```{r, echo=FALSE}
bread = read.table(file = 'data/bread.txt', header = TRUE)
```
a) The 18 slices came from a single loaf, but were randomized to the 6 combinations of conditions. Present an R-code for this randomization process.
```{r, echo=TRUE}
# The randomization process for 18 slices
# Take hours column from the data
hours = as.vector(as.matrix(bread$hours))
# Create environment column
environment = rep(c('cold', 'intermediate', 'warm'), each = 6)
# Create humidity column
humidity = rep(c('dry', 'wet'), each = 9)
# Converting to data frame
data.frame(cbind(hours, environment, humidity))
```

b) Make two boxplots of hours versus the two factors and two interaction plots (keeping the two factors fixed in turn).
```{r, echo=FALSE}
# Divide into two columns
par(mfrow=c(1, 2))
# Boxplot vs interaction plot in hours~environment
boxplot(hours~environment, data = bread)
interaction.plot(environment, humidity, hours, fixed = TRUE)
# Boxplot vs interaction plot in hours~humidity
boxplot(hours~humidity, data = bread)
interaction.plot(humidity, environment, hours, fixed = TRUE)
```

c) Perform an analysis of variance to test for effect of the factors temperature, humidity, and their interaction. Describe the interaction effect in words.

```{r, echo=TRUE}
# Creating linear model and ANOVA test
breadaov = lm(hours~environment*humidity, data = bread); anova(breadaov)
p_interaction = anova(breadaov)$Pr[3]
```
- The p-value for testing for $H_{0}$:$\gamma_{i,j}$ = 0 for all i, j is `r p_interaction`. Therefore, we reject the null hypothesis $H_{0}$ which means the interaction between environment and humidity is significant for this dataset.

d) Which of the two factors has the greatest (numerical) influence on the decay? Is this a good question?
```{r, echo=TRUE}
summary(breadaov)[4]
```

- When we look up to the variance analysis results, `r bread[7, ]` which corresponds to an environment with intermediate and dry has the most decaying effect in the dataset.

e) Check the model assumptions by using relevant diagnostic tools. Are there any outliers?

```{r, fig.height=4, echo=TRUE}
par(mfrow=c(2, 2))
# Plot the linear fitted model graphs
plot(breadaov)
```

- According to the tables we can say that `r bread[7,]` and `r bread[8,]` are the two that can be considered as outliers.

## Exercise 2

```{R, echo=FALSE}
search_data <- read.table("data/search.txt", header=TRUE)
```

a) Number the selected students 1 to 15 and show how (by using R) the students could be randomized to the interfaces in a randomized block design.

```{R, echo=TRUE}
# N <- as.vector(as.matrix(search_data$time))
# I <- as.vector(as.matrix(search_data$skill))
# B <- as.vector(as.matrix(search_data$interface))
# for (i in 1:B) print(sample(1:(N*I)))
xtabs(time~interface+skill,data=search_data)
```

b) Make some graphical summaries of the data. Are any interactions between interface and skill apparent?

```{R, echo=TRUE}
# interaction.plot(search_data$interface, search_data$skill, search_data$time)
# boxplot(search_data$interface, search_data$skill, search_data$time)
attach(search_data)
par(mfrow=c(1,2))
boxplot(time~interface)
boxplot(time~skill)

par(mfrow=c(1,2))
interaction.plot(skill,interface,time)
interaction.plot(interface,skill,time)
```

c) Test the null hypothesis that the search time is the same for all interfaces. Estimate the time it takes a typical user of skill level 3 to find the product on the website if the website uses interface 2.
d) Check the model assumptions by using relevant diagnostic tools.

```{R,echo=TRUE}
aovsearch=lm(time~interface+skill)
anova(aovsearch)
summary(aovsearch)
```

e) Perform the non-parametric Friedman test to test whether there is an effect of interface.

```{R, echo=TRUE}
friedman.test(time,interface,skill)
```
f) Test the null hypothesis that the search time is the same for all interfaces by a one-wayANOVA test, ignoring the variable skill. Is it right/wrong or useful/not useful to perform this test on this dataset? What assumption on the way the data were obtained is necessary for this test to be valid, and was this assumption met?

## Exercise 3

a) Test whether the type of feedingstuffs innfluences milk production using an ordinary "fixed effects" model, fitted with ```lm```. Estimate the difference in milk production.

b) Repeat a) and b) by performing a mixed effects analysis, modelling the cow effect as a random effect (use the function lmer). Compare your results to the results found by using a fixed effects model. (You will need to install the R-package lme4, which is not included in the standard distribution of R.)

c) Study the commands: 
```
  \> attach(cow) 
  \> t.test(milk[treatment=="A"],milk[treatment=="B"],paired=TRUE)
```
Does this produce a valid test for a difference in milk production? Is its conclusion compatible with the one obtained in a)? Why?