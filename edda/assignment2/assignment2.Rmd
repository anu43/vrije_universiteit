---
title: "assignment1"
author: "nihat uzunalioglu - 2660298, emiel kempen - 2640580, saurabh jain - 2666959"
date: "2/26/2020"
output: pdf_document
---

```{r setup, set.seed(43), include=FALSE}
knitr::opts_chunk$set(fig.height = 2.5)
options(show.signif.stars=FALSE)
```

## Exercise 1
```{r, echo=FALSE}
bread = read.table(file = 'data/bread.txt', header = TRUE)
```
a) The 18 slices came from a single loaf, but were randomized to the 6 combinations of conditions. Present an R-code for this randomization process.
```{r, echo=TRUE}
# The randomization process for 18 slices
# Take hours column from the data
hours = as.vector(as.matrix(bread$hours))
# Create environment column
environment = rep(c('cold', 'intermediate', 'warm'), each = 6)
# Create humidity column
humidity = rep(c('dry', 'wet'), each = 9)
# Converting to data frame
data.frame(cbind(hours, environment, humidity))
```

b) Make two boxplots of hours versus the two factors and two interaction plots (keeping the two factors fixed in turn).
```{r, echo=FALSE}
# Divide into two columns
par(mfrow=c(1, 2))
# Boxplot vs interaction plot in hours~environment
boxplot(hours~environment, data = bread)
interaction.plot(environment, humidity, hours, fixed = TRUE)
# Boxplot vs interaction plot in hours~humidity
boxplot(hours~humidity, data = bread)
interaction.plot(humidity, environment, hours, fixed = TRUE)
```

c) Perform an analysis of variance to test for effect of the factors temperature, humidity, and their interaction. Describe the interaction effect in words.

```{r, echo=TRUE}
# Creating linear model and ANOVA test
breadaov = lm(hours~environment*humidity, data = bread); anova(breadaov)
p_interaction = anova(breadaov)$Pr[3]
```
- The p-value for testing for $H_{0}$:$\gamma_{i,j}$ = 0 for all i, j is `r p_interaction`. Therefore, we reject the null hypothesis $H_{0}$ which means the interaction between environment and humidity is significant for this dataset.

d) Which of the two factors has the greatest (numerical) influence on the decay? Is this a good question?
```{r, echo=TRUE}
summary(breadaov)[4]
```

- When we look up to the variance analysis results, `r bread[7, ]` which corresponds to an environment with intermediate and dry has the most decaying effect in the dataset.

e) Check the model assumptions by using relevant diagnostic tools. Are there any outliers?

```{r, fig.height=4, echo=TRUE}
par(mfrow=c(2, 2))
# Plot the linear fitted model graphs
plot(breadaov)
```

- According to the tables we can say that `r bread[7,]` and `r bread[8,]` are the two that can be considered as outliers.